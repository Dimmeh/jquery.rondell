/*!
  jQuery rondell plugin
  @name jquery.rondell.js
  @author Sebastian Helzle (sebastian@helzle.net or @sebobo)
  @version 0.8.4
  @date 12/21/2011
  @category jQuery plugin
  @copyright (c) 2009-2011 Sebastian Helzle (www.sebastianhelzle.net)
  @license Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
*/
var __bind=function(a,b){return function(){return a.apply(b,arguments)}};(function(a){var b;a.rondell={version:"0.8.4",name:"rondell",defaults:{showContainer:true,resizeableClass:"resizeable",smallClass:"itemSmall",hiddenClass:"itemHidden",currentLayer:0,container:null,radius:{x:300,y:50},center:{left:400,top:200},size:{width:null,height:null},visibleItems:"auto",scaling:2,opacityMin:0.05,fadeTime:300,zIndex:1000,itemProperties:{delay:100,cssClass:"rondellItem",size:{width:150,height:150},sizeFocused:{width:0,height:0}},repeating:true,alwaysShowCaption:false,autoRotation:{enabled:false,paused:false,_timer:-1,direction:0,once:false,delay:5000},controls:{enabled:true,fadeTime:400,margin:{x:20,y:20}},strings:{prev:"prev",next:"next"},mousewheel:{enabled:true,threshold:5,minTimeBetweenShifts:300,_lastShift:0},touch:{enabled:true,preventDefaults:true,threshold:100,_start:void 0,_end:void 0},funcEase:"easeInOutQuad",theme:"default",preset:"",effect:null}};if(!a.easing.easeInOutQuad){a.easing.easeInOutQuad=function(f,g,e,i,h){if((g/=h/2)<1){return i/2*g*g+e}else{return -i/2*((--g)*(g-2)-1)+e}}}b=(function(){c.rondellCount=0;c.activeRondell=null;function c(e,f,d){if(d==null){d=void 0}this.keyDown=__bind(this.keyDown,this);this.isFocused=__bind(this.isFocused,this);this._autoShift=__bind(this._autoShift,this);this.shiftRight=__bind(this.shiftRight,this);this.shiftLeft=__bind(this.shiftLeft,this);this._refreshControls=__bind(this._refreshControls,this);this.shiftTo=__bind(this.shiftTo,this);this.layerFadeOut=__bind(this.layerFadeOut,this);this.layerFadeIn=__bind(this.layerFadeIn,this);this._hover=__bind(this._hover,this);this._onTouch=__bind(this._onTouch,this);this._onMousewheel=__bind(this._onMousewheel,this);this._start=__bind(this._start,this);this._loadItem=__bind(this._loadItem,this);this._onloadItem=__bind(this._onloadItem,this);this._initItem=__bind(this._initItem,this);this._getItem=__bind(this._getItem,this);this.hideCaption=__bind(this.hideCaption,this);this.showCaption=__bind(this.showCaption,this);this.id=c.rondellCount++;this.items=[];this.maxItems=f;this.loadedItems=0;this.initCallback=d;if((e!=null?e.preset:void 0) in a.rondell.presets){a.extend(true,this,a.rondell.defaults,a.rondell.presets[e.preset],e||{})}else{a.extend(true,this,a.rondell.defaults,e||{})}this.itemProperties.sizeFocused={width:this.itemProperties.sizeFocused.width||this.itemProperties.size.width*this.scaling,height:this.itemProperties.sizeFocused.height||this.itemProperties.size.height*this.scaling};this.size={width:this.size.width||this.center.left*2,height:this.size.height||this.center.top*2}}c.prototype.funcLeft=function(e,d){return d.center.left-d.itemProperties.size.width/2+Math.sin(e)*d.radius.x};c.prototype.funcTop=function(e,d){return d.center.top-d.itemProperties.size.height/2+Math.cos(e)*d.radius.y};c.prototype.funcDiff=function(e,d){return Math.pow(Math.abs(e)/d.maxItems,0.5)*Math.PI};c.prototype.funcOpacity=function(e,d){if(d.visibleItems>1){return Math.max(0,1-Math.pow(e/d.visibleItems,2))}else{return 0}};c.prototype.funcSize=function(e,d){return 1};c.prototype.showCaption=function(d){return a(".rondellCaption.overlay",this._getItem(d).object).css({height:"auto",overflow:"auto"}).stop(true).fadeTo(300,1)};c.prototype.hideCaption=function(e){var d;d=a(".rondellCaption.overlay:visible",this._getItem(e).object);return d.css({height:d.height(),overflow:"hidden"}).stop(true).fadeTo(200,0)};c.prototype._getItem=function(d){return this.items[d-1]};c.prototype._initItem=function(f,j){var l,k,i,g,e,d,h=this;this.items[f-1]=j;i=(g=j.icon)!=null?g.siblings():void 0;if(!((i!=null?i.length:void 0)||j.icon)&&j.object.children().length){i=j.object.children()}if(!i.length){l=j.object.attr("title")||((e=j.icon)!=null?e.attr("alt"):void 0)||((d=j.icon)!=null?d.attr("title"):void 0);if(l){i=a("<p>"+l+"</p>");j.object.append(i)}}if(i.length){k=a('<div class="rondellCaption"></div>');if(j.icon){k.addClass("overlay")}i.wrapAll(k)}j.object.addClass("rondellItemNew "+this.itemProperties.cssClass).css({opacity:0,width:j.sizeSmall.width,height:j.sizeSmall.height,left:this.center.left-j.sizeFocused.width/2,top:this.center.top-j.sizeFocused.height/2}).bind("mouseover mouseout click",function(m){switch(m.type){case"mouseover":if(j.object.is(":visible")&&!j.hidden){return j.object.addClass("rondellItemHovered")}break;case"mouseout":return j.object.removeClass("rondellItemHovered");case"click":if(j.object.is(":visible")&&!(h.currentLayer===f||j.hidden)){h.shiftTo(f);return m.preventDefault()}}});this.loadedItems+=1;if(this.loadedItems===this.maxItems){return this._start()}};c.prototype._onloadItem=function(d,j,e){var p,h,n,l,g,o,i,f,k,m;if(e==null){e=void 0}l=a("img:first",j);g=l.hasClass(this.resizeableClass);i=d;o=this.itemProperties.size;n=this.itemProperties.sizeFocused;f=this.scaling;h=m=(e!=null?e.width():void 0)||(e!=null?e[0].width:void 0)||l[0].width||l.width();p=k=(e!=null?e.height():void 0)||(e!=null?e[0].height:void 0)||l[0].height||l.height();if(e!=null){e.remove()}if(!(m&&k)){return}if(g){if(m>=k){k*=o.width/m;p*=n.width/h;m=o.width;h=n.width}else{m*=o.height/k;h*=n.height/p;k=o.height;p=n.height}}else{m=o.width;k=o.height;h=n.width;p=n.height}return this._initItem(i,{object:j,icon:l,small:false,hidden:false,resizeable:g,sizeSmall:{width:m,height:k},sizeFocused:{width:h,height:p}})};c.prototype._loadItem=function(e,f){var h,d,g=this;d=a("img:first",f);if(d[0].complete&&d[0].width){return this._onloadItem(e,f)}else{h=a('<img style="display:none"/>');a("body").append(h);return h.one("load",function(){return g._onloadItem(e,f,h)}).attr("src",d.attr("src"))}};c.prototype._start=function(){var d;this.currentLayer=Math.max(0,Math.min(this.currentLayer||Math.round(this.maxItems/2),this.maxItems));if(this.visibleItems==="auto"){this.visibleItems=Math.max(2,Math.floor(this.maxItems/2))}d=this.controls;if(d.enabled){this.controls._shiftLeft=a('<a class="rondellControl rondellShiftLeft" href="#"/>').text(this.strings.prev).click(this.shiftLeft).css({left:d.margin.x,top:d.margin.y,"z-index":this.zIndex+this.maxItems+2});this.controls._shiftRight=a('<a class="rondellControl rondellShiftRight" href="#/"/>').text(this.strings.next).click(this.shiftRight).css({right:d.margin.x,top:d.margin.y,"z-index":this.zIndex+this.maxItems+2});this.container.append(this.controls._shiftLeft,this.controls._shiftRight)}a(document).keydown(this.keyDown);if(this.mousewheel.enabled&&(a.fn.mousewheel!=null)){this.container.bind("mousewheel",this._onMousewheel)}if(this._onMobile()){if(this.touch.enabled){this.container.bind("touchstart touchmove touchend",this._onTouch)}}else{this.container.bind("mouseover mouseout",this._hover)}this.container.removeClass("initializing");if(typeof this.initCallback==="function"){this.initCallback(this)}return this.shiftTo(this.currentLayer)};c.prototype._onMobile=function(){return typeof Modernizr!=="undefined"&&Modernizr!==null?Modernizr.touch:void 0};c.prototype._onMousewheel=function(i,l,n,m){var g,h,k,j,f;if(!(this.mousewheel.enabled&&this.isFocused())){return}g=(new Date()).getTime();if(g-this.mousewheel._lastShift<this.mousewheel.minTimeBetweenShifts){return}k=a(window);f=k.scrollTop();j=f+k.height();h=this.container.offset().top+this.container.outerHeight()/2;if(h>f&&h<j&&Math.abs(n)>=this.mousewheel.threshold){if(n<0){this.shiftLeft()}else{this.shiftRight()}return this.mousewheel._lastShift=g}};c.prototype._onTouch=function(d){var g,f;if(!this.touch.enabled){return}f=d.originalEvent.touches[0]||d.originalEvent.changedTouches[0];switch(d.type){case"touchstart":this.touch._start={x:f.pageX,y:f.pageY};break;case"touchmove":if(this.touch.preventDefaults){d.preventDefault()}this.touch._end={x:f.pageX,y:f.pageY};break;case"touchend":if(this.touch._start&&this.touch._end){g=this.touch._end.x-this.touch._start.x;if(Math.abs(g)>this.touch.threshold){if(g>0){this.shiftLeft()}if(g<0){this.shiftRight()}}this.touch._start=this.touch._end=void 0}}return true};c.prototype._hover=function(f){var d;d=this.autoRotation.paused;if(f.type==="mouseover"){c.activeRondell=this.id;this.hovering=true;if(!d){this.autoRotation.paused=true;this.showCaption(this.currentLayer)}}else{this.hovering=false;if(d&&!this.autoRotation.once){this.autoRotation.paused=false;this._autoShift()}if(!this.alwaysShowCaption){this.hideCaption(this.currentLayer)}}if(this.controls.enabled){return this._refreshControls()}};c.prototype.layerFadeIn=function(f){var g,d,e,h,i=this;g=this._getItem(f);g.small=false;e=g.sizeFocused.width;d=g.sizeFocused.height;g.object.stop(true).show(0).css("z-index",this.zIndex+this.maxItems).addClass("rondellItemFocused").animate({width:e,height:d,left:this.center.left-e/2,top:this.center.top-d/2,opacity:1},this.fadeTime,this.funcEase,function(){i._autoShift();if(i.hovering||i.alwaysShowCaption||i._onMobile()){return i.showCaption(f)}});if(g.icon&&!g.resizeable){h=(this.itemProperties.sizeFocused.height-g.icon.height())/2;return g.icon.stop(true).animate({marginTop:h,marginBottom:h},this.fadeTime)}};c.prototype.layerFadeOut=function(i){var o,j,q,g,l,f,e,n,h,m,d,r,p,k=this;q=this._getItem(i);e=Math.abs(i-this.currentLayer);n=i;if(e>this.visibleItems&&this.repeating){if(this.currentLayer+this.visibleItems>this.maxItems){n+=this.maxItems}else{if(this.currentLayer-this.visibleItems<=this.maxItems){n-=this.maxItems}}e=Math.abs(n-this.currentLayer)}f=this.funcDiff(n-this.currentLayer,this);if(n<this.currentLayer){f*=-1}l=q.sizeSmall.width*this.funcSize(f,this);g=q.sizeSmall.height*this.funcSize(f,this);d=this.funcLeft(f,this)+(this.itemProperties.size.width-l)/2;r=this.funcTop(f,this)+(this.itemProperties.size.height-g)/2;p=this.zIndex+(f<0?n:-n);o=this.fadeTime+this.itemProperties.delay*e;j=q.object.hasClass("rondellItemNew");if(j||e<=this.visibleItems){this.hideCaption(i);m=this.funcOpacity(e,this);if(m>=this.opacityMin){q.object.show()}q.object.removeClass("rondellItemNew rondellItemFocused").stop(true).css("z-index",p).animate({width:l,height:g,left:d,top:r,opacity:m},o,this.funcEase,function(){if(q.object.css("opacity")<k.opacityMin){return q.object.hide()}else{return q.object.show()}});q.hidden=false;if(!q.small){q.small=true;if(q.icon&&!q.resizeable){h=(this.itemProperties.size.height-q.icon.height())/2;return q.icon.stop(true).animate({marginTop:h,marginBottom:h},o)}}}else{if(q.hidden){return q.object.css({left:d,top:r,"z-index":p})}else{q.hidden=true;return q.object.stop(true).css("z-index",p).animate({opacity:0},o/2,this.funcEase,function(){},this.hideCaption(i))}}};c.prototype.shiftTo=function(e){var d,f;if(this.repeating){if(e<1){e=this.maxItems}else{if(e>this.maxItems){e=1}}}if(e>0&&e<=this.maxItems){this.currentLayer=e;for(d=1,f=this.maxItems;1<=f?d<=f:d>=f;1<=f?d++:d--){if(d!==this.currentLayer){this.layerFadeOut(d)}}this.layerFadeIn(this.currentLayer)}return this._refreshControls()};c.prototype._refreshControls=function(){if(!this.controls.enabled){return}this.controls._shiftLeft.stop().fadeTo(this.controls.fadeTime,this.currentLayer>1||this.repeating&&this.hovering?1:0);return this.controls._shiftRight.stop().fadeTo(this.controls.fadeTime,this.currentLayer<this.maxItems||this.repeating&&this.hovering?1:0)};c.prototype.shiftLeft=function(d){if(d!=null){d.preventDefault()}return this.shiftTo(this.currentLayer-1)};c.prototype.shiftRight=function(d){if(d!=null){d.preventDefault()}return this.shiftTo(this.currentLayer+1)};c.prototype._autoShift=function(){var e,d=this;e=this.autoRotation;if(this.isActive()&&e.enabled&&e._timer<0){return e._timer=window.setTimeout(function(){d.autoRotation._timer=-1;if(d.isActive()&&!e.paused){if(e.direction){return d.shiftRight()}else{return d.shiftLeft()}}},e.delay)}};c.prototype.isActive=function(){return true};c.prototype.isFocused=function(){return c.activeRondell===this.id};c.prototype.keyDown=function(d){if(this.isActive()&&this.isFocused()){if(this.autoRotation._timer>=0){window.clearTimeout(this.autoRotation._timer);this.autoRotation._timer=-1}switch(d.which){case 37:return this.shiftLeft(d);case 39:return this.shiftRight(d)}}};return c})();return a.fn.rondell=function(d,e){var c;if(d==null){d={}}if(e==null){e=void 0}c=new b(d,this.length,e);c.container=this.wrapAll(a('<div class="rondellContainer initializing rondellTheme_'+c.theme+'"/>').css(c.size)).parent();if(c.showContainer){c.container.parent().show()}this.each(function(f){var g,h;h=a(this);g=f+1;if(a("img:first",h).length){return c._loadItem(g,h)}else{return c._initItem(g,{object:h,icon:null,small:false,hidden:false,resizeable:false,sizeSmall:c.itemProperties.size,sizeFocused:c.itemProperties.sizeFocused})}});return c}})(jQuery);
/*!
  Presets for jQuery rondell plugin
  
  @author Sebastian Helzle (sebastian@helzle.net or @sebobo)
  @category jQuery plugin
  @copyright (c) 2009-2011 Sebastian Helzle (www.sebastianhelzle.net)
  @license Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
*/
(function(a){a.rondell=a.rondell||{};return a.rondell.presets={carousel:{autoRotation:{enabled:true,direction:1,once:false,delay:5000},funcSize:function(c,b){return(b.maxItems/Math.abs(c))/b.maxItems}},products:{repeating:false,alwaysShowCaption:true,visibleItems:4,itemProperties:{delay:0},center:{left:400,top:100},funcTop:function(c,b){return 0},funcDiff:function(c,b){return Math.abs(c)+1},funcLeft:function(c,b){return b.center.left+(c-0.5)*b.itemProperties.size.width},funcOpacity:function(c,b){return 0.8}},pages:{radius:{x:0,y:0},scaling:1,visibleItems:1,controls:{enabled:false},funcTop:function(c,b){return b.center.top-b.itemProperties.size.height/2},funcLeft:function(c,b){return b.center.left+c*b.itemProperties.size.width},funcDiff:function(c,b){return Math.abs(c)+0.5}},cubic:{funcTop:function(c,b){return b.center.top-b.itemProperties.size.height/2+Math.pow(c/2,3)*b.radius.x},funcLeft:function(c,b){return b.center.left-b.itemProperties.size.width/2+Math.sin(c)*b.radius.x},funcSize:function(c,b){return Math.pow((Math.PI-Math.abs(c))/Math.PI,3)}}}})(jQuery);